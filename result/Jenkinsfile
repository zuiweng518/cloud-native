pipeline{
  agent none
stages{
		environment{
		        HARBOR_URL     = "hub.docker.com"
                IMAGE_PUSH_DESTINATION="zuiweng518/web"
                IMAGE_TAG = "v1.0"
                BUILD_IMAGE="${IMAGE_PUSH_DESTINATION}:${IMAGE_TAG}"
                BUILD_IMAGE_LATEST="${IMAGE_PUSH_DESTINATION}:latest"
		}
		stage {
		container(name: 'kaniko', shell: '/busybox/sh') {
                    withEnv(['PATH+EXTRA=/busybox']) {
                        sh '''#!/busybox/sh
                            cd result
                            /kaniko/executor --context `pwd` --destination $IMAGE_PUSH_DESTINATION --insecure
                        '''
                    }
                }
	}
   }
}
